<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopSmarter AI Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Include Lucide Icons (or your preferred icon library) -->
    <script src="https://unpkg.com/lucide-react@0.292.0/dist/umd/lucide-react.min.js"></script> 
    <!-- Note: lucide-react.min.js is for React, for vanilla JS you might need to find a different way or use SVG strings -->
    <!-- Better: Use an icon font or direct SVGs. For simplicity, we'll try to use JS to create them if possible or use text placeholders. -->
    <!-- For a quick hackathon, you can embed SVGs or use unicode characters. -->
</head>
<body>
    <div class="app-container">
        <header>
            <h1><span class="icon-placeholder">ü§ñ</span> ShopSmarter AI Assistant</h1>
            <button id="darkModeToggle" class="dark-mode-toggle" title="Toggle Dark Mode">
                <span class="icon-placeholder">üåô</span> <!-- Placeholder for Moon/Sun icon -->
            </button>
        </header>

        <main class="main-content">
            <div class="top-interaction-area">
                <!-- Image Upload Section -->
                <section class="section image-upload-area" id="imageUploadSection">
                    <h2><span class="icon-placeholder">üñºÔ∏è</span> Upload an Image</h2>
                    <input type="file" id="imageFile" name="imageFile" accept="image/*">
                    <div class="image-preview-container">
                        <img id="imagePreview" src="#" alt="Image Preview" style="display:none;" class="image-preview"/>
                        <span id="imagePreviewPlaceholder">Preview your image here</span>
                    </div>
                     <!-- Add a hidden input to store the current prompt for image upload -->
                    <input type="hidden" id="currentPromptForImageUpload" value="">
                </section>

                <!-- Chat Input Section -->
                <section class="section chat-input-area" id="chatInputSection">
                    <h2><span class="icon-placeholder">üí¨</span> Refine with a Prompt</h2>
                    <form id="promptForm">
                        <div class="prompt-input-wrapper">
                            <input type="text" id="promptInput" class="prompt-input" placeholder="e.g., 'dark blue jeans', 'elegant dress'">
                            <button type="button" id="clearPromptBtn" class="prompt-clear-btn" style="display:none;" title="Clear prompt">
                                <span class="icon-placeholder-small">‚ùå</span>
                            </button>
                        </div>
                        <button type="submit" id="sendPromptBtn"><span class="icon-placeholder-small">‚û§</span> Send</button>
                    </form>
                    <div class="prompt-examples">
                        <strong>Try:</strong>
                        <ul id="examplePromptsList">
                            <!-- JS will populate this -->
                        </ul>
                    </div>
                </section>
            </div>

            <!-- Recommendations Section -->
            <section class="section" id="recommendationsSection">
                <h2><span class="icon-placeholder">‚ú®</span> Recommendations</h2>
                <div id="loadingText" class="loading-text" style="display:none;">Searching for perfect matches...</div>
                <div id="noRecommendationsText" class="no-recommendations-text" style="display:none;">
                    <p>No recommendations found. Try another search!</p>
                </div>
                <div id="initialMessage" class="no-recommendations-text" style="display:none;">
                     <p>Upload an image or use a prompt. Initial suggestions are loading...</p>
                </div>
                <div id="recommendationGrid" class="recommendation-grid">
                    <!-- Product cards will be injected here by JS -->
                </div>
            </section>
            
            <!-- Wishlist Section -->
            <section class="section wishlist-display" id="wishlistSection">
                <h2><span class="icon-placeholder">‚ù§Ô∏è</span> Your Wishlist (<span id="wishlistCount">0</span>)</h2>
                <div id="emptyWishlistMessage" style="display:block;">
                    <p>Your wishlist is empty. Add items you love by clicking the heart icon!</p>
                </div>
                <ul id="wishlistItemsList" class="wishlist-items-list">
                    <!-- Wishlist items will be injected here by JS -->
                </ul>
            </section>

            <!-- Checkout Section -->
            <section class="section checkout-area" id="checkoutSection">
                <h2><span class="icon-placeholder">üí≥</span> Checkout Summary</h2>
                <div id="emptyCartMessage">
                    <p class="checkout-summary">Your cart is empty. Select some products to add them here!</p>
                </div>
                <div id="cartContents" style="display:none;">
                    <p id="cartSummaryText" class="checkout-summary">You have <strong><span id="cartItemCount">0</span></strong> item(s) selected.</p>
                    <ul id="cartItemsList" class="cart-items-list">
                        <!-- Cart items will be injected here by JS -->
                    </ul>
                    <p id="cartTotal" class="checkout-total"><strong>Total: $<span id="cartTotalPrice">0.00</span></strong></p>
                    <button id="proceedToCheckoutBtn" class="proceed-to-checkout-btn" disabled>
                        <span class="icon-placeholder-small">üõí</span> Proceed to Checkout
                    </button>
                </div>
            </section>
        </main>

        <!-- Product Modal -->
        <div id="productModalOverlay" class="product-modal-overlay" style="display:none;">
            <div id="productModal" class="product-modal">
                <button id="productModalCloseBtn" class="product-modal-close-button btn-icon-subtle">
                    <span class="icon-placeholder-large">‚ùå</span>
                </button>
                <div class="product-modal-content">
                    <div class="product-modal-image-section">
                        <img id="modalMainImage" src="#" alt="Product Image" class="main-image">
                        <!-- Thumbnails if multiple images -->
                        <div id="modalThumbnails" class="product-modal-thumbnails"></div>
                    </div>
                    <div class="product-modal-details-section">
                        <h3 id="modalProductName">Product Name</h3>
                        <p id="modalProductPrice" class="price">$0.00</p>
                        <p id="modalProductDescription" class="description">Description here...</p>
                        <div id="modalProductAttributes" class="attributes">
                            <!-- Attributes like size, color -->
                        </div>
                        <div id="modalRecommendationReason" class="recommendation-reason" style="display:none;">
                            <strong>Why Recommended:</strong> <span id="modalReasonText"></span>
                            <ul id="modalDetailedReasonsList" class="detailed-reasons-modal" style="list-style-type: disc; padding-left: 20px; margin-top: 5px;"></ul>
                        </div>
                        <div class="product-modal-actions">
                            <button id="modalToggleWishlistBtn" class="wishlist-btn">
                                <span class="icon-placeholder-small">‚ù§Ô∏è</span> <span id="modalWishlistBtnText">Add to Wishlist</span>
                            </button>
                            <button id="modalToggleCartBtn" class="add-to-cart-btn">
                                <span class="icon-placeholder-small">‚ûï</span> <span id="modalCartBtnText">Add to Cart</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>¬© <span id="currentYear"></span> ShopSmarter AI. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Pass initial recommendations from Flask to JavaScript
        const initialRecommendationsFromServer = {{ initial_recommendations | safe }};
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>